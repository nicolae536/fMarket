<div class="users-page">
    <!-- TODO catch close event -->
    <action-dialog
            [title]="'Delete'"
            [positive-label]="'Delete'"
            (loaded)="referenceActionDialogInComponent($event)"
            (action-confirmed)="actionDialogConfirmDelete($event)">
    </action-dialog>
    <create-user-dialog
            [city-list]="cityList"
            [status-list]="statusList"
            (loaded)="referenceCreateUserDialogInComponent($event)"
            (create-user)="confirmCreateUser()">
    </create-user-dialog>
    <div class="page-title">
        <div class="row">
            <div class="secondary">
                <input type="button" class="btn btn-primary" (click)="createAccount()" value="Adauga user"/>
            </div>
            <span class="h3">Conturi</span>
        </div>
    </div>
    <div class="page-content">
        <div class="row">
            <div class="filters">

                <div class="clearfix filter-container">
                    <div class="col-md-2 col-xs-12">
                        <div class="form-group">
                            <span>Id:</span>
                            <input type="text" [(ngModel)]="idFilter" placeholder="0"
                                   class="form-control"/>
                        </div>
                    </div>
                    <div class="col-md-2 col-xs-12">
                        <div class="form-group">
                            <span>Email:</span>
                            <input type="text" [(ngModel)]="emailFilter" placeholder="user@domain.com"
                                   class="form-control"/>
                        </div>
                    </div>
                    <div class="col-md-2 col-xs-12">
                        <div class="form-group">
                            <span>Name:</span>
                            <input type="text" [(ngModel)]="nameFilter" placeholder="Andrei" class="form-control"/>
                        </div>
                    </div>
                    <div class="col-md-2 col-xs-12">
                        <span>Status:</span>

                        <div>
                            <select class="user-status-select" [(ngModel)]="selectedStatusFilter">
                                <option *ngFor="let option of statusList" [value]="option.status">{{option.displayName}}
                                </option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-2 col-xs-12">
                        <span>City:</span>

                        <div>
                            <select class="user-status-select" [(ngModel)]="cityId">
                                <option *ngFor="let option of cityList" [value]="option.id">{{option.name}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="secondary">
                        <button class="btn btn-success" (click)="applyFilters()">Aplica Filtre</button>
                    </div>
                </div>
            </div>
            <table class="table table-striped" cellspacing="0" width="100%">
                <thead>
                <tr>
                    <th class="col-md-1 col-sm-2 col-xs-2">Id</th>
                    <th class="col-md-3 col-sm-4 col-xs-4">Email</th>
                    <th class="col-md-3 col-sm-4 col-xs-4">Name</th>
                    <th class="col-md-1 hidden-sm hidden-xs">Status</th>
                    <th class="col-md-3 hidden-sm hidden-xs">City</th>
                    <th class="col-md-1 hidden-sm hidden-xs" colspan="2">Actiuni</th>
                </tr>
                </thead>
                <tbody class="table-body">
                <tr *ngFor="let user of usersList"  [ngClass]="user.isInEditMode ? 'success':''">
                    <td>
                        <span>{{user.id}}</span>
                    </td>
                    <td>
                        <span *ngIf="!user.isInEditMode">{{user.email}}</span>
                        <input *ngIf="user.isInEditMode" type="text" class="form-control" [(ngModel)]="user.email"/>
                    </td>
                    <td>
                        <span *ngIf="!user.isInEditMode">{{user.name}}</span>
                        <input *ngIf="user.isInEditMode" type="text" class="form-control" [(ngModel)]="user.name"/>
                    </td>
                    <td class="fit-select-to-td hidden-sm hidden-xs">
                        <span *ngIf="!user.isInEditMode">{{user.status}}</span>
                        <select *ngIf="user.isInEditMode" class="user-status-select" [(ngModel)]="user.status">
                            <option *ngFor="let option of statusList" [value]="option.status">{{option.displayName}}
                            </option>
                        </select>
                    </td>
                    <td class="fit-select-to-td hidden-sm hidden-xs">
                        <span *ngIf="!user.isInEditMode">{{user.city}}</span>
                        <select *ngIf="user.isInEditMode" class="user-status-select" [(ngModel)]="user.cityId">
                            <option *ngFor="let option of cityList" [value]="option.id">{{option.name}}</option>
                        </select>
                    </td>
                    <td class="hidden-sm hidden-xs">
                        <a href="javascript:void(0)" *ngIf="!user.isInEditMode" (click)="toggleEditMode(user)">
                            <span class="glyphicon glyphicon-cog"></span>
                        </a>
                        <a href="javascript:void(0)" *ngIf="user.isInEditMode" (click)="saveEditedUser(user)">
                            <span *ngIf="user.isInEditMode" class="glyphicon glyphicon-ok"></span>
                        </a>
                    </td>
                    <td class="hidden-sm hidden-xs">
                        <a href="javascript:void(0)" (click)="deleteUser(user)">
                            <span class="glyphicon glyphicon-trash"></span>
                        </a>
                    </td>
                </tr>
                <tr class="navigation-row">
                    <td colspan="7" class="navigation-column">
                        <pagination [totalItems]="pagination.totalItems" [(ngModel)]="pagination.currentPage"
                                    (ngModelChange)="getUsers()" [maxSize]="pagination.maxSize" class="pagination-sm"
                                    [boundaryLinks]="true" [rotate]="false" (numPages)="numPages = $event"></pagination>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>